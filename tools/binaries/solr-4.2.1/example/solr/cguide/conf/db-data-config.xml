<dataConfig>  
    <dataSource type="JdbcDataSource"
            driver="com.microsoft.sqlserver.jdbc.SQLServerDriver"
            url="jdbc:sqlserver://localhost\SQLEXPRESS2008;databaseName=Guide;user=sa;password=el78Taxi;" 	/> 
             
    <document>  
    
	<entity name="TestEntity" query="SELECT DISTINCT S.ID, S.Name as Seller, C.Name as City, Convert(varchar, Latitude) + ',' + Convert(varchar, Longitude) as LatLng, Case Rating when 0 then '*'
when 1 then '**' 
when 2 then '***' 
when 3 then '****' 
when 4 then '*****' 
End as Rating
        FROM Seller S 
        INNER JOIN SubCategorySeller SCS on  S.ID = SCS.Seller_ID
        INNER JOIN SubCategory SC on  SC.ID = SCS.SubCategory_ID
        INNER JOIN Location L on S.HeadLocationId = L.ID AND L.Deleted is null
        INNER JOIN City C on C.ID = L.CityId
        WHERE S.Deleted is null
        ORDER BY Rating">

        <entity name="attributes" query="select name AS Attributes
            from Attribute A
            inner join AttributeSeller [AS] on A.ID = [AS].Attribute_ID
            where [AS].Seller_ID ='${TestEntity.ID}'">
        </entity>

        <entity name="subcategories" query="select name AS SubCategories
            from SubCategory SC
            inner join SubCategorySeller SCS on SC.ID = SCS.SubCategory_ID
            where SCS.Seller_ID ='${TestEntity.ID}'">
        </entity>

         <entity name="categories" query="select distinct C.name AS Categories
            from SubCategory SC
            inner join Category C on C.ID = SC.CategoryId
            inner join SubCategorySeller SCS on SC.ID = SCS.SubCategory_ID
            where SCS.Seller_ID ='${TestEntity.ID}'">
        </entity>

        <field column="Id" name="id" />
        <field column="Seller" name="seller" />  
        <field column="City" name="city" />  
	    <field column="LatLng" name="latlng" />  
		<field column="Rating" name="rating" />  
      </entity>  
    </document>  
</dataConfig> 

